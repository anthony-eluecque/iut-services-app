<template>
  <div class="rectangle"></div> 
    <section class="container d-flex flex-column">
        <v-container fluid>
            <v-card class="login-card">
                <v-card-title class="text-center">CONNEXION AUX SERVICES</v-card-title>
                <v-form @submit.prevent="login">
                    <v-text-field v-model="email" label="Entrez votre adresse mail" required></v-text-field>
                    <v-text-field v-model="password" label="Entrez votre mot de passe" type="password" required></v-text-field>
                    <p v-if="!isEmailValid" class="login-error">
                      Veuillez rentrer une adresse e-mail valide
                    </p>
                    <p v-if="userStore.errorAuth" class="login-error">{{ userStore.errorAuth }}</p>
                    <v-btn type="submit" color="primary" block>Se connecter</v-btn>
                </v-form>
            </v-card>
        </v-container>
    </section>
</template>
  
<script lang="ts" setup>
import axios from 'axios'
import { useUserStore } from '@/store'
import { ref } from 'vue';

const userStore = useUserStore()


const email = ref<string>('') 
const password = ref<string>('') 

const isEmailValid = ref(true);

const validateEmail = (email: string) => {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}
const login = () => {
  if (!validateEmail(email.value)) {
        // Si l'adresse e-mail n'est pas valide, d√©finissez isEmailValid sur false
        isEmailValid.value = false;
        return;
  }
  else {
    isEmailValid.value = true;
    userStore.login(email.value, password.value);
  }
}
</script>
  
<style scoped>
  .rectangle {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 20vh; /* Ajustez la hauteur selon vos besoins */
    background-color: #E3E3E3;
}
  .login-card {
    max-width: 700px;
    height: 700px;
    margin: auto;
    padding: 20px;
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0px 0px 10px #4A66F2;

  }

  .login-error {
    color: #e51522;
    margin-bottom: 8px;
  }
  
  .v-text-field {
    width: 100%;
  }

  .container {
    background: linear-gradient(180deg, rgba(74, 102, 242, 0.68) 0%, #4A66F2 100%);
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  </style>